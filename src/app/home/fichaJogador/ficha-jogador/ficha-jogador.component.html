<div class="headerFicha">
    <div class="headerFicha__avatar">
        <img [src]="jogador.avatar" alt="Avatar do jogador">
    </div>
    <div class="headerFicha__info">

        <p><strong>Nome: <br></strong>{{jogador.nome}}</p>
        <p><strong>Classe:<br></strong>{{jogador.classe}}</p>
        <p><strong>Raça:<br></strong>{{jogador.raca}}</p>
        <p><strong>Pro<br></strong>{{jogador.proficiencia}}</p>
        <p><strong>Nv<br></strong>{{jogador.nivel}}</p>
    </div>
</div>


<button class="btn btn-secondary btn-sm m-1" type="button" data-bs-toggle="collapse" data-bs-target="#collapseMagias"
    aria-expanded="false" aria-controls="collapseMagias">
    Magias
</button>
<div class="collapse" id="collapseMagias">
    <div class="fichaJogador">
        <div class="d-flex justify-content-around w-100">
            <p><strong>Magias</strong></p>
            <button type="button" class="btn btn-primary btn-sm m-1" (click)="adicionarMagia()">Add</button>
        </div>
        <div class="fichaJogador__magias__item" style="font-size: x-small;">
            <ng-container *ngFor="let magia of jogador.magias">
                <p>
                    <strong>{{magia.nome}}</strong>: {{magia.descricao}}<br>
                </p>
            </ng-container>
        </div>
        <div *ngIf="adicionandoMagia">
            <input type="text" class="m-1" placeholder="Nome da Magia" [(ngModel)]="novaMagia.nome">
            <input type="text" class="m-1" placeholder="Descrição da Magia" [(ngModel)]="novaMagia.descricao">
            <button type="button" class="btn btn-success btn-sm m-1"
                (click)="confirmarAdicionarMagia()">Confirmar</button>
            <button type="button" class="btn btn-danger btn-sm m-1" (click)="cancelarAdicionarMagia()">Cancelar</button>
        </div>
    </div>
</div>

<button class="btn btn-secondary btn-sm m-1" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTalentos"
    aria-expanded="false" aria-controls="collapseTalentos">
    Talentos
</button>
<div class="collapse" id="collapseTalentos">
    <div class="fichaJogador">
        <div class="d-flex justify-content-around w-100">
            <p><strong>Talentos</strong></p>
            <button type="button" class="btn btn-primary btn-sm m-1" (click)="adicionarTalento()">Add</button>
        </div>
        <div class="fichaJogador__talentos__item" style="font-size: x-small;">
            <ng-container *ngFor="let talento of jogador.talentos">
                <p>
                    <strong>{{talento.nome}}</strong>: {{talento.descricao}}<br>
                    <button type="button" class="btn btn-danger btn-sm m-1"
                        (click)="removerTalento(talento)">Remover</button>
                </p>
            </ng-container>
        </div>
        <div *ngIf="adicionandoTalento">
            <input type="text" class="m-1" placeholder="Nome do Talento" [(ngModel)]="novoTalento.nome">
            <input type="text" class="m-1" placeholder="Descrição do Talento" [(ngModel)]="novoTalento.descricao">
            <button type="button" class="btn btn-success btn-sm m-1"
                (click)="confirmarAdicionarTalento()">Confirmar</button>
            <button type="button" class="btn btn-danger btn-sm m-1"
                (click)="cancelarAdicionarTalento()">Cancelar</button>
        </div>
    </div>
</div>
<button class="btn btn-secondary btn-sm m-1" type="button" data-bs-toggle="collapse" data-bs-target="#collapseMochila"
    aria-expanded="false" aria-controls="collapseMochila">
    Mochila
</button>
<div class="collapse" id="collapseMochila">
    <div class="fichaJogador">
        <div class="d-flex justify-content-around w-100">
            <p><strong>Mochila</strong></p>
            <button type="button" class="btn btn-primary btn-sm m-1" (click)="adicionarItem()">Add</button>
        </div>
        <div class="fichaJogador__mochila__item" style="font-size: x-small;">
            <ng-container *ngFor="let item of jogador.mochila">
                <p>
                    <strong>{{item.nome}}</strong>: {{item.descricao}}<br>
                    <button type="button" class="btn btn-danger btn-sm m-1"
                        (click)="removerItem(item)">Remover</button>
                </p>
            </ng-container>
        </div>
        <div *ngIf="adicionandoItem">
            <input type="text" class="m-1" placeholder="Nome do Item" [(ngModel)]="novoItem.nome">
            <input type="text" class="m-1" placeholder="Descrição do Item" [(ngModel)]="novoItem.descricao">
            <button type="button" class="btn btn-success btn-sm m-1"
                (click)="confirmarAdicionarItem()">Confirmar</button>
            <button type="button" class="btn btn-danger btn-sm m-1" (click)="cancelarAdicionarItem()">Cancelar</button>
        </div>
    </div>
</div>


<div class="d-flex">
    <div class="fichaJogador__combate mt-1 col-6">
        <p><strong>Combate</strong></p>
        <div class="fichaJogador__combate__item" style="font-size: x-small;">
            <p><strong>PV:</strong> <input type="number" style="width: 1.3rem;" [(ngModel)]="jogador.pv" (change)="saveToCache()"></p>
            <p><strong>PVA:</strong> <input type="number" style="width: 1.3rem;" [(ngModel)]="jogador.pva" (change)="saveToCache()"></p>
            <p><strong>CA:</strong> <input type="number" style="width: 1.3rem;" [(ngModel)]="jogador.ca" (change)="saveToCache()"></p>
            <p><strong>Des:</strong> <input type="number" style="width: 1.3rem;" [(ngModel)]="jogador.deslocamento" (change)="saveToCache()"></p>
            <p><strong>Inic:</strong> <input type="number" style="width: 1.3rem;" [(ngModel)]="jogador.iniciativa" (change)="saveToCache()"></p>
            <p><strong>Insp:</strong> <input type="number" style="width: 1.3rem;" [(ngModel)]="jogador.inspiracao" (change)="saveToCache()"></p>
    
        </div>
    </div>
    <div class="fichaJogador__atributos mt-1 col-6">
        <p><strong>Atributos</strong></p>
        <div class="fichaJogador__atributos__item" style="font-size: x-small;">
            <p class="mx-1"><strong>For:</strong> {{ calcularModificador(jogador.atributos.forca) }}</p>
            <p class="mx-1"><strong>:</strong> {{ jogador.atributos.forca }}</p>
            <p class="mx-1"><strong>Des:</strong> {{ calcularModificador(jogador.atributos.destreza) }}</p>
            <p class="mx-1"><strong>:</strong> {{ jogador.atributos.destreza }}</p>
            <p class="mx-1"><strong>Con:</strong> {{ calcularModificador(jogador.atributos.constituicao) }}</p>
            <p class="mx-1"><strong>:</strong> {{ jogador.atributos.constituicao }}</p>
            <p class="mx-1"><strong>Int:</strong> {{ calcularModificador(jogador.atributos.inteligencia) }}</p>
            <p class="mx-1"><strong>:</strong> {{ jogador.atributos.inteligencia }}</p>
            <p class="mx-1"><strong>Sab:</strong> {{ calcularModificador(jogador.atributos.sabedoria) }}</p>
            <p class="mx-1"><strong>:</strong> {{ jogador.atributos.sabedoria }}</p>
            <p class="mx-1"><strong>Car:</strong> {{ calcularModificador(jogador.atributos.carisma) }}</p>
            <p class="mx-1"><strong>:</strong> {{ jogador.atributos.carisma }}</p>
            <p class="mx-1"><strong>Sor:</strong> {{ calcularModificador(jogador.atributos.sorte) }}</p>
            <p class="mx-1"><strong>:</strong> {{ jogador.atributos.sorte }}</p>
            
        </div>
    </div>
</div>

<div class="d-flex">



    <div class="fichaJogador__pericias">

        <div class="fichaJogador__condicoes">
            <p><strong>Condições</strong></p>
            <div class="fichaJogador__condicoes__item" style="font-size: xx-small;">
                <p><strong>Fome:</strong> <input type="number" [(ngModel)]="jogador.fome" (change)="saveToCache()">
                </p>
                <p><strong>Sede:</strong> <input type="number" [(ngModel)]="jogador.sede" (change)="saveToCache()">
                </p>
                <p><strong>Cansaço:</strong> <input type="number" [(ngModel)]="jogador.cansaco"
                        (change)="saveToCache()">
                </p>
                <p><strong>Calor:</strong> <input type="number" [(ngModel)]="jogador.calor" (change)="saveToCache()">
                </p>
                <p><strong>Frio:</strong> <input type="number" [(ngModel)]="jogador.frio" (change)="saveToCache()">
                </p>
                <p><strong>Sono:</strong> <input type="number" [(ngModel)]="jogador.sono" (change)="saveToCache()">
                </p>
            </div>
        </div>
        <div class="">
            <p class="m-0"><strong>Perícias</strong></p>
            <div class="fichaJogador__pericias__item" style="font-size: x-small;">
                <ng-container *ngFor="let pericia of jogador.pericias">
                    <p  class="mx-1" *ngIf="pericia.valor === 'sim'">
                        <strong>{{pericia.nome}} <br> </strong>
                    </p>
                </ng-container>
            </div>

        </div>


    </div>




    <div class="fichaJogador col-6">
        <div class="fichaJogador__equipamentos ">
            <div class="d-flex justify-content-around w-100">
                <p><strong>Equipamentos</strong></p>
                <button type="button" class="btn btn-primary btn-sm m-1" (click)="adicionarEquipamento()">Add</button>
            </div>
            <div class="fichaJogador__equipamentos__item" style="font-size: x-small;">
                <ng-container *ngFor="let categoria of ['cabeca', 'armadura', 'pes','escudo', 'anel','amuleto']">
                    <ng-container class="col-12" *ngFor="let equipamento of jogador.equipamentos[categoria]">
                      <div class="mx-2">
                        <p class="col-8 d-inline-block">
                            <strong>{{equipamento.nome}}</strong>: {{equipamento.descricao}}
                        </p>
                        
                        <button type="button" class="btn btn-danger btn-sm col-2 d-inline-block"
                                (click)="removerEquipamento(categoria, equipamento)">X</button><br>
                      </div>
                    </ng-container>
                </ng-container>
            </div>
        </div>
        
        <div *ngIf="adicionandoEquipamento" class="fichaJogador__adicionarEquipamento">
            <div class="itens_Equipamentos d-flex">
                <select class="form-select m-1" [(ngModel)]="novaCategoria">
                    <option value="" disabled selected>Selecione a Categoria</option>
                    <option value="cabeca">Cabeça</option>
                    <option value="armadura">Armadura</option>
                    <option value="pes">Pés</option>
                    <option value="escudo">Escudo</option>
                    <option value="amuleto">Amuleto</option>
                    <option value="anel">Anel</option>
                </select>
                <input type="text" class="m-1" placeholder="Nome do Equipamento" [(ngModel)]="novoEquipamento.nome">
                <input type="text" class="m-1" placeholder="Descrição do Equipamento"
                    [(ngModel)]="novoEquipamento.descricao">
                <button type="button" class="btn btn-success btn-sm m-1"
                    (click)="confirmarAdicionarEquipamento()">Confirmar</button>
                <button type="button" class="btn btn-danger btn-sm m-1"
                    (click)="cancelarAdicionarEquipamento()">Cancelar</button>
            </div>
        </div>
    </div>
</div>





<button class="btn btn-secondary btn-sm m-1" (click)="baixarJogador()">Baixar Jogador</button>
<input type="file" class="m-1" (change)="carregarJogador($event)" accept=".json">
<button class="btn btn-danger btn-sm m-1" (click)="confirmarLimparCache()">Limpar Cache</button>

<div style="background-color: brown;" *ngIf="confirmandoLimparCache" class="confirmacao">
    <p><strong>Tem certeza que deseja limpar o cache?</strong></p>
    <button class="btn btn-success btn-sm m-1" (click)="limparCache()">Sim</button>
    <button class="btn btn-secondary btn-sm m-1" (click)="cancelarLimparCache()">Não</button>
</div>